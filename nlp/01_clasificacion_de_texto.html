<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Procesamiento de Texto 📚 – DatosBook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Procesamiento de Texto 📚 – DatosBook">
<meta property="og:description" content="Repositorio pque recolecta el contenido de Ingeniería de Datos y lo presenta en una página web usando nbdev.">
<meta property="og:site_name" content="DatosBook">
<meta name="twitter:title" content="Procesamiento de Texto 📚 – DatosBook">
<meta name="twitter:description" content="Repositorio pque recolecta el contenido de Ingeniería de Datos y lo presenta en una página web usando nbdev.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DatosBook</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Buscar"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">C13 - NLP</li><li class="breadcrumb-item"><a href="../nlp/01_clasificacion_de_texto.html">Procesamiento de texto</a></li><li class="breadcrumb-item"><a href="../nlp/01_clasificacion_de_texto.html">Procesamiento de Texto 📚</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenido al Libro de Datos</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">C00 - Intro a Modelos Pre-Entrenados</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Teachable Machines</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../techeable-machines/00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a Teachable Machine de Google</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../techeable-machines/01_actividad_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorando Teachable Machine</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Procesamiento de Imágenes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../imagenes_como_dato/01_imgDato.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parte 1: Comprensión de Imágenes en Blanco y Negro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../imagenes_como_dato/02_imgDato.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parte 2: Comprensión de Imágenes en Color</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Biblioteca P5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../p5/01_p5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notas sobre p5.js</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../p5/02_p5_ini_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Como usar un Proyecto p5.js en VSCode</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelos TM + P5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tm_p5/01_clasificador.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clasificador de Día y Noche</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tm_p5/02_codigo_clasificador.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Código Clasificador día/noche</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tm_p5/03_snake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Snake Game</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tm_p5/04_codigo_snake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explicación del Código del Juego de la Serpiente en p5.js</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tm_p5/05_codigo_snake_con_gestos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explicación del Código del Juego de la Serpiente en p5.js (Con gestos)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">p5 + ml5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../p5_ml5/01_sound_classifier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clasificador de Sonido</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../p5_ml5/02_codigo_clasificador_sonido.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Código Clasificador de Sonido</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../p5_ml5/03_codigo_image_classifier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Código Clasificador de Imágenes</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">C01 - Intro EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Intro</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectura y procesamiento de datos desde un archivo CSV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/01_simple_api.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extracción de datos de la API REST Countries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/02_eda_basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis (EDA) de Títulos de Netflix</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">C10 - Usando Github en Windows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_github/00_consideraciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consideraciones</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Métodos</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_github/01_personal_token.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTTPS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_github/02_ssh_key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SSH</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_github/03_github_desktop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub Desktop</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">C11 - Usando nbdev</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nbdev_tutorial/antes_de_usar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Antes de usar nbdev</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nbdev_tutorial/primeros_pasos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primeros pasos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nbdev_tutorial/primera_edicion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primera edición</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">C12 - Exploración de Datos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">API Getonbrd</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exploracion_de_datos/getonbrd/getonbrd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploración de Datos (getonbrd api)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">API Spotify</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exploracion_de_datos/spotify/spotify.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploración de Datos (spotify api)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">C13 - NLP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">Clasificación de texto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nlp/00_predicciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clasificación de Texto</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true">
 <span class="menu-text">Procesamiento de texto</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nlp/01_clasificacion_de_texto.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Procesamiento de Texto 📚</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true">
 <span class="menu-text">C14 - Association Rules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">Ejemplo 1</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../association-rules/00_ejemplo_1.1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a las Reglas de Asociación</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">Ejemplo 2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../association-rules/02_ejemplo_1.2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Implementación del ejemplo con python</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">Ejercicio</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../association-rules/03_ejercicio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Determine las reglas de asociación para el siguiente conjunto de transacciones</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#preprocesamiento" id="toc-preprocesamiento" class="nav-link active" data-scroll-target="#preprocesamiento">1. <strong>Preprocesamiento</strong>:</a></li>
  <li><a href="#bag-of-words" id="toc-bag-of-words" class="nav-link" data-scroll-target="#bag-of-words">2. <strong>Bag of Words</strong>:</a></li>
  <li><a href="#clasificador-de-bayes" id="toc-clasificador-de-bayes" class="nav-link" data-scroll-target="#clasificador-de-bayes">3. <strong>Clasificador de Bayes</strong>:</a></li>
  <li><a href="#logistic-regression-regresión-logística" id="toc-logistic-regression-regresión-logística" class="nav-link" data-scroll-target="#logistic-regression-regresión-logística">4. <strong>Logistic Regression (Regresión Logística)</strong>:</a></li>
  <li><a href="#qué-es-la-clasificación-de-texto" id="toc-qué-es-la-clasificación-de-texto" class="nav-link" data-scroll-target="#qué-es-la-clasificación-de-texto">¿Qué es la clasificación de texto?</a></li>
  <li><a href="#qué-haremos-a-continuación" id="toc-qué-haremos-a-continuación" class="nav-link" data-scroll-target="#qué-haremos-a-continuación">¿Qué haremos a continuación?</a>
  <ul class="collapse">
  <li><a href="#cargar-los-datasets" id="toc-cargar-los-datasets" class="nav-link" data-scroll-target="#cargar-los-datasets">Cargar los datasets</a></li>
  <li><a href="#nuestro-primer-sistema-de-clasificación" id="toc-nuestro-primer-sistema-de-clasificación" class="nav-link" data-scroll-target="#nuestro-primer-sistema-de-clasificación">Nuestro primer sistema de clasificación</a></li>
  </ul></li>
  <li><a href="#el-clasificador" id="toc-el-clasificador" class="nav-link" data-scroll-target="#el-clasificador">El clasificador</a>
  <ul class="collapse">
  <li><a href="#preprocesamiento-del-texto" id="toc-preprocesamiento-del-texto" class="nav-link" data-scroll-target="#preprocesamiento-del-texto">Preprocesamiento del texto</a></li>
  <li><a href="#sistema-de-clasificación-con-preprocesamiento" id="toc-sistema-de-clasificación-con-preprocesamiento" class="nav-link" data-scroll-target="#sistema-de-clasificación-con-preprocesamiento">Sistema de clasificación con preprocesamiento</a></li>
  <li><a href="#clasificación-usando-regresión-logísitica" id="toc-clasificación-usando-regresión-logísitica" class="nav-link" data-scroll-target="#clasificación-usando-regresión-logísitica">Clasificación usando Regresión Logísitica</a></li>
  <li><a href="#n-gramas" id="toc-n-gramas" class="nav-link" data-scroll-target="#n-gramas">N-gramas</a></li>
  <li><a href="#bonus-clasificación-de-autoría-de-documentos" id="toc-bonus-clasificación-de-autoría-de-documentos" class="nav-link" data-scroll-target="#bonus-clasificación-de-autoría-de-documentos">Bonus: Clasificación de Autoría de documentos</a></li>
  </ul></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias">Referencias</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dci-courses/DatosBook/issues/new" class="toc-action"><i class="bi bi-github"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">C13 - NLP</li><li class="breadcrumb-item"><a href="../nlp/01_clasificacion_de_texto.html">Procesamiento de texto</a></li><li class="breadcrumb-item"><a href="../nlp/01_clasificacion_de_texto.html">Procesamiento de Texto 📚</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Procesamiento de Texto 📚</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El objetivo principal de esta clase es introducirlos a la clasificación de texto en NLP. Para esto, implementaremos varios modelos de clasificación destinados a <strong>predecir la categoría de noticias de la radio biobio</strong>.</p>
<p>Los modelos y métodos que usaremos serán los siguientes:</p>
<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="preprocesamiento" class="level3">
<h3 class="anchored" data-anchor-id="preprocesamiento">1. <strong>Preprocesamiento</strong>:</h3>
<p>El preprocesamiento es el conjunto de técnicas aplicadas a los datos antes de ser utilizados por un modelo de aprendizaje automático. Las técnicas que usaremos son:</p>
<ul>
<li><p><strong>Tokenización</strong>: Es el proceso de dividir un texto en unidades más pequeñas llamadas <em>tokens</em>. Los tokens pueden ser palabras, frases o incluso caracteres individuales, según el nivel de granularidad que se necesite. Por ejemplo, la frase “Hola mundo” se tokeniza como [“Hola”, “mundo”].</p></li>
<li><p><strong>Stemming</strong>: Es una técnica que reduce las palabras a su raíz o forma base. El objetivo es agrupar diferentes formas de una palabra, de modo que puedan tratarse como la misma entidad. Por ejemplo, “corriendo”, “corre” y “correr” se reducirían a la raíz “corr”.</p></li>
<li><p><strong>Lematización</strong>: Similar al stemming, pero en lugar de reducir las palabras a su raíz, la lematización convierte las palabras a su forma base o lema según el contexto. Por ejemplo, “correrá” se convierte en “correr”. La lematización tiene en cuenta el significado gramatical, lo que la hace más precisa que el stemming.</p></li>
<li><p><strong>Eliminación de Stop Words</strong>: Las <em>stop words</em> son palabras comunes que no aportan mucho significado a la tarea de análisis, como “el”, “la”, “en”, “de”. Eliminar estas palabras puede ayudar a reducir el ruido en los datos y mejorar la eficiencia del modelo.</p></li>
</ul>
</section>
<section id="bag-of-words" class="level3">
<h3 class="anchored" data-anchor-id="bag-of-words">2. <strong>Bag of Words</strong>:</h3>
<p>El modelo de <strong>Bag of Words (BoW)</strong> es una técnica simple de representación de texto donde un documento o conjunto de palabras se convierte en un conjunto de palabras únicas y su frecuencia dentro de ese documento. Se ignora la gramática y el orden de las palabras, y solo se cuenta cuántas veces aparece cada palabra en el documento. Es un enfoque común para convertir texto en datos que pueden ser usados por modelos de aprendizaje automático. El resultado suele ser una matriz en la que cada fila representa un documento y cada columna representa una palabra única.</p>
</section>
<section id="clasificador-de-bayes" class="level3">
<h3 class="anchored" data-anchor-id="clasificador-de-bayes">3. <strong>Clasificador de Bayes</strong>:</h3>
<p>El <strong>Clasificador de Bayes</strong> es un algoritmo de clasificación basado en el teorema de Bayes, que calcula la probabilidad de que una instancia pertenezca a una clase dada, en función de sus características. El modelo de Bayes más conocido es el <strong>Naive Bayes</strong>, que asume que las características son independientes entre sí. A pesar de esta suposición ingenua, Naive Bayes es muy eficaz para tareas de clasificación de texto como el filtrado de spam y la categorización de documentos.</p>
</section>
<section id="logistic-regression-regresión-logística" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-regresión-logística">4. <strong>Logistic Regression (Regresión Logística)</strong>:</h3>
<p>La <strong>Regresión Logística</strong> es un modelo de clasificación supervisado que se utiliza para predecir la probabilidad de que una instancia pertenezca a una de dos clases posibles. Aunque se llama “regresión”, se utiliza principalmente para problemas de clasificación binaria. La regresión logística estima la probabilidad de que una instancia pertenezca a una clase basándose en una función sigmoide que produce un valor entre 0 y 1. Si el valor es mayor que un umbral (generalmente 0.5), se clasifica la instancia en una clase; de lo contrario, en la otra.</p>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd    </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer  </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline, FeatureUnion</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, f1_score, classification_report</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> SnowballStemmer</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spacy.lang.es.stop_words <span class="im">import</span> STOP_WORDS</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"es_core_news_sm"</span>, disable<span class="op">=</span>[<span class="st">'ner'</span>, <span class="st">'parser'</span>, <span class="st">'tagger'</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entonces,</p>
</section>
<section id="qué-es-la-clasificación-de-texto" class="level3">
<h3 class="anchored" data-anchor-id="qué-es-la-clasificación-de-texto">¿Qué es la clasificación de texto?</h3>
<p>La clasificación de texto consiste en tomar distintos textos y asignarles alguna clase. Dichas clases varían según la task que queramos resolver. Por ejemplo:</p>
<pre><code>- Detectar emails SPAM -&gt; SPAM, NO SPAM
- Reviews de Peliculas -&gt; Buena, Mas o menos, Mala, Malísima, Brutalmente mala.
- Análisis de sentimientos de tweets: Felicidad, Tristeza, Enojo, Ira,...
- Detectar Fake News -&gt; Es, No es
- Lenguaje del texto -&gt; Español, Inglés, Chino,...
- Categoría de una noticia -&gt; Nacional, Internacional, Economía, Sociedad, Opinión...
- Autor de un texto -&gt; Cada autor es una clase distinta.</code></pre>
<p>Se define formalmente como:</p>
<ul>
<li><p>Input:</p>
<ul>
<li>Un documento <span class="math inline">\(d\)</span></li>
<li>Un conjunto fijo de clases <span class="math inline">\(c_1, c_2, ..., c_j\)</span></li>
</ul></li>
<li><p>Output:</p>
<ul>
<li>Una clase <span class="math inline">\(c \in C\)</span> para el documento</li>
</ul></li>
</ul>
<p>Hay dos clases de métodos para resolver estos problemas:</p>
<ol type="1">
<li><p><strong>Hand-coded Rules 🤙</strong>:</p>
<p>Establecemos a mano las reglas que permiten detectar las clases.</p></li>
<li><p><strong>Supervised Machine Learning 💻</strong>:</p>
<p>Entrenamos clasificadores a partir de muchos ejemplos de documentos etiquetados a mano.</p></li>
</ol>
<hr>
</section>
<section id="qué-haremos-a-continuación" class="level2">
<h2 class="anchored" data-anchor-id="qué-haremos-a-continuación">¿Qué haremos a continuación?</h2>
<p>Clasificaremos las noticias de la radio biobio en 20 categorías o tópicos:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>[</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'america-latina'</span>, <span class="st">'eeuu'</span>, <span class="st">'europa'</span>, <span class="st">'chile'</span>, <span class="st">'region-metropolitana'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'region-del-bio-bio'</span>, <span class="st">'negocios-y-empresas'</span>, <span class="st">'region-de-los-lagos'</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'actualidad-economica'</span>, <span class="st">'region-de-valparaiso'</span>, <span class="st">'region-de-la-araucania'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'curiosidades'</span>, <span class="st">'asia'</span>, <span class="st">'region-de-los-rios'</span>, <span class="st">'entrevistas'</span>, <span class="st">'debates'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mediooriente'</span>, <span class="st">'viral'</span>, <span class="st">'animales'</span>, <span class="st">'tu-bolsillo'</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Los pasos a seguir serán:</p>
<ol type="1">
<li><p>Primero que nada, descargaremos los datos con los que trabajaremos.</p></li>
<li><p>Luego, crearemos el sistema mas básico. Este consiste en transformar nuestro texto a <code>Bag of Words (BoW)</code> y luego, usar esos vectores para entrenar un clasificador. Este sistema nos puede entregar un muy buen baseline para comenzar a mejorar.</p></li>
<li><p>Evaluaremos nuestro clasificador según las métricas.</p></li>
<li><p>A continuación, veremos como mejorar aun mas nuestros resultados. Para esto agregaremos muchas mas técnicas vistas en cátedra, tales como el preprocesamiento de texto y probar con clasificadores aún mas sofisticados.</p></li>
</ol>
<section id="cargar-los-datasets" class="level3">
<h3 class="anchored" data-anchor-id="cargar-los-datasets">Cargar los datasets</h3>
<p>Los datos que usaremos son 5000 documentos con noticias dividas en 20 categorías. Las noticias fueron obtenidas desde la página de la radio biobio. Cada categoría contiene 250 documentos (noticias).</p>
<p>Los cargaremos directamente desde un archivo utilizando la librería <code>pandas</code> 🐼:</p>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.read_json(<span class="st">'datos/biobio_clean.json'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dataset_r <span class="op">=</span> dataset.copy(deep<span class="op">=</span><span class="va">True</span>) <span class="co"># respaldo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dataset</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">author_link</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">link</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">subcategory</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">tags</th>
<th data-quarto-table-cell-role="th">embedded_links</th>
<th data-quarto-table-cell-role="th">publication_datetime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Yerko Roa</td>
<td>/lista/autores/yroa</td>
<td>Colapsa otro segmento de casa que se derrumbó ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-valparaiso</td>
<td>Noticia en Desarrollo Estamos recopilando m...</td>
<td>[]</td>
<td>[]</td>
<td>1565778000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Valentina González</td>
<td>/lista/autores/vgonzalez</td>
<td>Policía busca a mujer acusada de matar a su pa...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Detectives de la Policía de Investigaciones ...</td>
<td>[#parricidio, #PDI, #Pudahuel, #Región Metropo...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565771820000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Dos detenidos en Liceo de Aplicación: protagon...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Dos detenidos fue el saldo de una serie de i...</td>
<td>[#Incendio, #Liceo de Aplicación, #Región Metr...</td>
<td>[]</td>
<td>1565772480000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Matías Vega</td>
<td>/lista/autores/mvega</td>
<td>Apoyo transversal: Senado aprueba en general p...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>La sala del Senado aprobó en general el proy...</td>
<td>[#Inmigración, #Inmigrantes, #Ley, #Migración,...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565772720000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Valentina González</td>
<td>/lista/autores/vgonzalez</td>
<td>Evacuación espontánea en Instituto Nacional po...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>La mañana de este miércoles se produjo una e...</td>
<td>[#Carabineros, #FFEE, #Gases Lacrimógenos, #In...</td>
<td>[]</td>
<td>1565772960000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26408</td>
<td>Manuel Stuardo</td>
<td>/lista/autores/mstuardo</td>
<td>Naciones Unidas abre proceso de postulaciones ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>Las Naciones Unidas abrió un proceso de post...</td>
<td>[#cambio climático, #COP25, #Naciones Unidas, ...</td>
<td>[]</td>
<td>1565764200000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26409</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Fernando Astengo chocó en estado de ebriedad e...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>El exfutbolista Fernando Astengo protagonizó...</td>
<td>[#Accidente, #Fernando Astengo, #Peñalolén, #R...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565767440000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26410</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Detuvieron a hombre que arrojó combustible a u...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Personal de Carabineros detuvo a un hombre q...</td>
<td>[#Indigente, #Parque Forestal, #Región Metropo...</td>
<td>[]</td>
<td>1565769300000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26411</td>
<td>Nicolás Parra</td>
<td>/lista/autores/nparra</td>
<td>Revelan identidad de 2 de 6 víctimas fatales e...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-valparaiso</td>
<td>El intendente de Valparaíso, Jorge Martínez,...</td>
<td>[#derrumbe en valparaíso, #Región de Valparaís...</td>
<td>[]</td>
<td>1565771100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26412</td>
<td>Emilio Lara</td>
<td>/lista/autores/elara</td>
<td>Senado cerrará cuenta paralela al presupuesto ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>El presidente del Senado, Jaime Quintana (PP...</td>
<td>[#Dipres, #Fiscalía, #Hacienda, #Senado]</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565771640000</td>
</tr>
</tbody>
</table>

<p>26413 rows × 10 columns</p>
</div>
</div>
</div>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El número de noticias por clase lo pueden cambiar despues modificando la constante NUM_SAMPLES.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># noten que el número de noticias en el dataset original por categoría está desbalanceada.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sample intentará sacar la mayor cantidad de ejemplos y retornará siempre, incluso si devuelve </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># menos de los que le pidieron.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>NUM_SAMPLES <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>categorias <span class="op">=</span> dataset[<span class="st">'subcategory'</span>].unique()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>categorias</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['region-de-valparaiso', 'region-metropolitana', 'chile',
       'region-de-los-lagos', 'region-del-maule', 'entrevistas', 'tu-voz',
       'america-latina', 'negocios-y-empresas', 'europa',
       'actualidad-economica', 'eeuu', 'africa', 'curiosidades', 'mundo',
       'asia', 'tu-bolsillo', 'mediooriente', 'debate', 'animales',
       'misterios', 'viral', 'oceania', 'consejos', 'salud',
       'region-del-bio-bio', 'region-de-la-araucania',
       'region-de-los-rios', 'region-de-magallanes',
       'region-de-antofagasta', 'region-de-ohiggins', 'region-de-atacama',
       'region-de-tarapaca', 'region-de-aysen', 'region-de-coquimbo',
       'region-de-arica-y-parinacota', 'region-de-nuble', 'videos',
       'educacion-group-nacional', 'viajes', 'fotos-ciudadanas',
       'cronicas', 'test'], dtype=object)</code></pre>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>categorias_seleccionadas <span class="op">=</span> [</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'america-latina'</span>, <span class="st">'eeuu'</span>, <span class="st">'europa'</span>, <span class="st">'chile'</span>, <span class="st">'region-metropolitana'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'region-del-bio-bio'</span>, <span class="st">'negocios-y-empresas'</span>, <span class="st">'region-de-los-lagos'</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'actualidad-economica'</span>, <span class="st">'region-de-valparaiso'</span>, <span class="st">'region-de-la-araucania'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'curiosidades'</span>, <span class="st">'asia'</span>, <span class="st">'region-de-los-rios'</span>, <span class="st">'entrevistas'</span>, <span class="st">'debates'</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mediooriente'</span>, <span class="st">'viral'</span>, <span class="st">'animales'</span>, <span class="st">'tu-bolsillo'</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar solo las categorías seleccionadas</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dataset_filtrado <span class="op">=</span> dataset[dataset[<span class="st">'subcategory'</span>].isin(categorias_seleccionadas)]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>dataset_filtrado</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">author_link</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">link</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">subcategory</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">tags</th>
<th data-quarto-table-cell-role="th">embedded_links</th>
<th data-quarto-table-cell-role="th">publication_datetime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Yerko Roa</td>
<td>/lista/autores/yroa</td>
<td>Colapsa otro segmento de casa que se derrumbó ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-valparaiso</td>
<td>Noticia en Desarrollo Estamos recopilando m...</td>
<td>[]</td>
<td>[]</td>
<td>1565778000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Valentina González</td>
<td>/lista/autores/vgonzalez</td>
<td>Policía busca a mujer acusada de matar a su pa...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Detectives de la Policía de Investigaciones ...</td>
<td>[#parricidio, #PDI, #Pudahuel, #Región Metropo...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565771820000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Dos detenidos en Liceo de Aplicación: protagon...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Dos detenidos fue el saldo de una serie de i...</td>
<td>[#Incendio, #Liceo de Aplicación, #Región Metr...</td>
<td>[]</td>
<td>1565772480000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Matías Vega</td>
<td>/lista/autores/mvega</td>
<td>Apoyo transversal: Senado aprueba en general p...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>La sala del Senado aprobó en general el proy...</td>
<td>[#Inmigración, #Inmigrantes, #Ley, #Migración,...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565772720000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Valentina González</td>
<td>/lista/autores/vgonzalez</td>
<td>Evacuación espontánea en Instituto Nacional po...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>La mañana de este miércoles se produjo una e...</td>
<td>[#Carabineros, #FFEE, #Gases Lacrimógenos, #In...</td>
<td>[]</td>
<td>1565772960000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26408</td>
<td>Manuel Stuardo</td>
<td>/lista/autores/mstuardo</td>
<td>Naciones Unidas abre proceso de postulaciones ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>Las Naciones Unidas abrió un proceso de post...</td>
<td>[#cambio climático, #COP25, #Naciones Unidas, ...</td>
<td>[]</td>
<td>1565764200000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26409</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Fernando Astengo chocó en estado de ebriedad e...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>El exfutbolista Fernando Astengo protagonizó...</td>
<td>[#Accidente, #Fernando Astengo, #Peñalolén, #R...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565767440000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26410</td>
<td>Felipe Delgado</td>
<td>/lista/autores/fdelgado</td>
<td>Detuvieron a hombre que arrojó combustible a u...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-metropolitana</td>
<td>Personal de Carabineros detuvo a un hombre q...</td>
<td>[#Indigente, #Parque Forestal, #Región Metropo...</td>
<td>[]</td>
<td>1565769300000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26411</td>
<td>Nicolás Parra</td>
<td>/lista/autores/nparra</td>
<td>Revelan identidad de 2 de 6 víctimas fatales e...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-valparaiso</td>
<td>El intendente de Valparaíso, Jorge Martínez,...</td>
<td>[#derrumbe en valparaíso, #Región de Valparaís...</td>
<td>[]</td>
<td>1565771100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26412</td>
<td>Emilio Lara</td>
<td>/lista/autores/elara</td>
<td>Senado cerrará cuenta paralela al presupuesto ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/c...</td>
<td>nacional</td>
<td>chile</td>
<td>El presidente del Senado, Jaime Quintana (PP...</td>
<td>[#Dipres, #Fiscalía, #Hacienda, #Senado]</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1565771640000</td>
</tr>
</tbody>
</table>

<p>23865 rows × 10 columns</p>
</div>
</div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener los valores únicos y el tamaño de cada subcategoría</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>valores_unicos <span class="op">=</span> dataset_filtrado[<span class="st">'subcategory'</span>].unique()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>tamanos_subcategorias <span class="op">=</span> dataset_filtrado.groupby(<span class="st">'subcategory'</span>).size()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un DataFrame con las subcategorías y sus tamaños</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df_subcategorias <span class="op">=</span> pd.DataFrame({</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Subcategoría'</span>: tamanos_subcategorias.index,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Tamaño'</span>: tamanos_subcategorias.values</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el DataFrame</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>df_subcategorias</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategoría</th>
<th data-quarto-table-cell-role="th">Tamaño</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>actualidad-economica</td>
<td>1040</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>america-latina</td>
<td>4149</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>animales</td>
<td>425</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>asia</td>
<td>757</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chile</td>
<td>1926</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>curiosidades</td>
<td>796</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>eeuu</td>
<td>2021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>entrevistas</td>
<td>663</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>europa</td>
<td>1976</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>mediooriente</td>
<td>527</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>negocios-y-empresas</td>
<td>1520</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>region-de-la-araucania</td>
<td>875</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>region-de-los-lagos</td>
<td>1345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>region-de-los-rios</td>
<td>694</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>region-de-valparaiso</td>
<td>901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>region-del-bio-bio</td>
<td>1631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>region-metropolitana</td>
<td>1699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>tu-bolsillo</td>
<td>418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>viral</td>
<td>502</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determinar el número mínimo de ejemplos entre las subcategorías</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>min_samples <span class="op">=</span> df_subcategorias[<span class="st">'Tamaño'</span>].<span class="bu">min</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"El número mínimo de ejemplos entre las subcategorías es: </span><span class="sc">{</span>min_samples<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Balancear el dataset seleccionando el número mínimo de ejemplos por subcategoría</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> dataset_filtrado.groupby(<span class="st">'subcategory'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicamos el balanceo y nos aseguramos de que el índice se restablezca correctamente</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>dataset_balanceado <span class="op">=</span> g.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(min_samples)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar el tamaño del dataset balanceado y por subcategoría</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tamaño del dataset balanceado: </span><span class="sc">{</span><span class="bu">len</span>(dataset_balanceado)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tamaño por subcategoría después del balanceo:"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dataset_balanceado.groupby(<span class="st">'subcategory'</span>).size())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>El número mínimo de ejemplos entre las subcategorías es: 418
Tamaño del dataset balanceado: 7942
Tamaño por subcategoría después del balanceo:
subcategory
actualidad-economica      418
america-latina            418
animales                  418
asia                      418
chile                     418
curiosidades              418
eeuu                      418
entrevistas               418
europa                    418
mediooriente              418
negocios-y-empresas       418
region-de-la-araucania    418
region-de-los-lagos       418
region-de-los-rios        418
region-de-valparaiso      418
region-del-bio-bio        418
region-metropolitana      418
tu-bolsillo               418
viral                     418
dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/n4/j3zj6_r13rv55gc2c5btztph0000gn/T/ipykernel_42780/3084681870.py:10: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  dataset_balanceado = g.apply(lambda x: x.sample(min_samples)).reset_index(drop=True)</code></pre>
</div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dataset.sample(<span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">author_link</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">link</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">subcategory</th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">tags</th>
<th data-quarto-table-cell-role="th">embedded_links</th>
<th data-quarto-table-cell-role="th">publication_datetime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17331</td>
<td>Matías Vega</td>
<td>/lista/autores/mvega</td>
<td>Sofofa responde a pedido del Gobierno de aumen...</td>
<td>https://www.biobiochile.cl/noticias/economia/a...</td>
<td>economia</td>
<td>actualidad-economica</td>
<td>La Sociedad de Fomento Fabril (Sofofa) respo...</td>
<td>[#Desempleo, #Ipc, #paciencia, #Sofofa]</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1533753840000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8253</td>
<td>Catalina Díaz</td>
<td>/lista/autores/catalinadiaz</td>
<td>Robo de 2.500 metros de cable de cobre nuevame...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-del-bio-bio</td>
<td>Un nuevo robo de alambre cobre del tendido e...</td>
<td>[#Mulchén, #Región de la Araucanía, #Temuco]</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1559147400000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7768</td>
<td>Manuel Cabrera</td>
<td>/lista/autores/mcabrera</td>
<td>Sigue crisis por basura en Chiloé: vecinos de ...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-los-lagos</td>
<td>Un complejo panorama es que se avizora para ...</td>
<td>[#Basura, #Chiloé, #Crisis, #Dalcahue, #Puerto...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1558790580000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15364</td>
<td>Yessenia Márquez</td>
<td>/lista/autores/ymarquez</td>
<td>Inmobiliara presenta recurso de protección con...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-los-lagos</td>
<td>Un recurso de protección en contra del direc...</td>
<td>[#Inmobiliaria Las Hortencias, #Los Angeles, #...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1562955600000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20057</td>
<td>Diego Vera</td>
<td>/lista/autores/dvera</td>
<td>Tras polémica con Google: EEUU da 90 días a Hu...</td>
<td>https://www.biobiochile.cl/noticias/internacio...</td>
<td>internacional</td>
<td>eeuu</td>
<td>El Departamento de Comercio de Estados Unido...</td>
<td>[#Estados Unidos, #Google, #Huawei]</td>
<td>[]</td>
<td>1558374600000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20248</td>
<td>Nicole Briones</td>
<td>/lista/autores/nbriones</td>
<td>La crisis del agua en Osorno no termina: vecin...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-los-lagos</td>
<td>En Osorno la crisis del agua no termina. Si ...</td>
<td>[#Contaminación, #crisis del agua, #Osorno, #R...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1564312980000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20448</td>
<td>Emilio Lara</td>
<td>/lista/autores/elara</td>
<td>Adelantan pago del "Bono Marzo": conoce los re...</td>
<td>https://www.biobiochile.cl/noticias/economia/t...</td>
<td>economia</td>
<td>tu-bolsillo</td>
<td>La tarde de este miércoles, el ministro del ...</td>
<td>[#Bono, #Bono Marzo, #Economía, #Instituto de ...</td>
<td>[]</td>
<td>1544631120000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1072</td>
<td>Diego Vera</td>
<td>/lista/autores/dvera</td>
<td>Bolsonaro se reúne con Macri en cita marcada p...</td>
<td>https://www.biobiochile.cl/noticias/internacio...</td>
<td>internacional</td>
<td>america-latina</td>
<td>El presidente de Brasil, Jair Bolsonaro, rec...</td>
<td>[#Argentina, #Jair Bolsonaro, #Mauricio Macri,...</td>
<td>[]</td>
<td>1547635200000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6362</td>
<td>Manuel Stuardo</td>
<td>/lista/autores/mstuardo</td>
<td>Juzgado de Garantía rechaza prisión preventiva...</td>
<td>https://www.biobiochile.cl/noticias/nacional/r...</td>
<td>nacional</td>
<td>region-de-los-rios</td>
<td>El Juzgado de Garantía de Los Lagos rechazó ...</td>
<td>[#ataque, #Femicidio Frustrado, #prisión preve...</td>
<td>[https://media.biobiochile.cl/wp-content/uploa...</td>
<td>1557769020000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1772</td>
<td>Diego Vera</td>
<td>/lista/autores/dvera</td>
<td>Guerra comercial: EEUU implementa una serie de...</td>
<td>https://www.biobiochile.cl/noticias/internacio...</td>
<td>internacional</td>
<td>eeuu</td>
<td>Estados Unidos comenzó a aplicar este lunes ...</td>
<td>[#Aranceles, #China, #Estados Unidos, #Guerra ...</td>
<td>[]</td>
<td>1537784100000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(dataset_balanceado.content,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                                    dataset_balanceado.subcategory,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                                    test_size<span class="op">=</span><span class="fl">0.33</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                                    random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>724       El presidente Jair Bolsonaro reivindicó esta...
765       El Poder Electoral venezolano descartó este ...
6900      Conmoción causó en Chile y en Brasil la noti...
4317      Durante los últimos años, los volúmenes de p...
4463      La Corte Suprema desestimó las alegaciones d...
                              ...                        
5226      Un trabajo entre las fiscalías de Puerto Mon...
5390      La temperatura más fría de la temporada inve...
860       El pasado 1 de enero , mientras muchos celeb...
7603      El gimnasio suele ser el lugar donde termina...
7270      El nuevo ministro del Trabajo, Nicolás Monck...
Name: content, Length: 5321, dtype: object</code></pre>
</div>
</div>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>X_test</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3286      Este miércoles se realizó una reunión en Cor...
3322      El diputado del Partido Socialista, Leonardo...
5004      Un ciudadano chileno, que fue sorprendido in...
1420      El líder norcoreano, Kim Jong Un, afirmó est...
3785      Bases militares y centros de investigación c...
                              ...                        
7552      La tranquilidad del entorno y sus aguas cris...
3570      Una polémica se registró la jornada de este ...
7395      El Gobierno postergó, una vez más, la presen...
6174      Un derrame de combustible se registró en la ...
3254      El Superintendente de Electricidad y Combust...
Name: content, Length: 2621, dtype: object</code></pre>
</div>
</div>
</section>
<section id="nuestro-primer-sistema-de-clasificación" class="level3">
<h3 class="anchored" data-anchor-id="nuestro-primer-sistema-de-clasificación">Nuestro primer sistema de clasificación</h3>
<p>Ahora que tenemos cargado el dataset, podemos implementar nuestro clasificador!</p>
<p>Para esto, usaremos 3 herramientas fundamentales de scikit-learn: un <code>pipeline</code>, <code>CountVectorizer</code> y <code>MultinomialNB</code>.</p>
<section id="pipeline" class="level4">
<h4 class="anchored" data-anchor-id="pipeline">Pipeline</h4>
<p>Un <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"><code>pipeline</code></a> es la definición de los procesos que llevará a cabo el sistema que creemos. Nos permite tener unificados todos los procesos a la vez que simplifica el código de nuestro sistema.</p>
<p>En nuestro caso, el pipeline será:</p>
<pre><code>Dataset -&gt; Bag of Words -&gt; NaiveBayes Clf</code></pre>
</section>
<section id="bag-of-words-y-countvectorizer" class="level4">
<h4 class="anchored" data-anchor-id="bag-of-words-y-countvectorizer">Bag of Words y CountVectorizer 🎒</h4>
<p>¿Qué era Bag of Words?</p>
<p>Es un modelo en donde transformamos cada una de las oraciones de nuestro dataset en vectores. Cada vector contiene una columna por cada palabra / <strong>token</strong> del vocabulario. Al procesar el dataset, cada oración es mapeada a un vector que cuenta las apariciones de cada una de sus tokens.</p>
<p>Referencia: <a href="https://es.wikipedia.org/wiki/Modelo_bolsa_de_palabras">BoW en wikipedia</a></p>
<p><strong>Un pequeño ejemplo</strong></p>
<p>Supongamos que nuestro tokenizador solo separa por espacios.</p>
<pre><code>- Doc1 : 'I love dogs'
- Doc2: 'I hate dogs and knitting.
- Doc3: 'Knitting is my hobby and my passion.</code></pre>
<p>El bag of words quedaría:</p>
<p><code>CountVectorizer</code> es la clase de <code>scikit</code> que transformará nuestro texto a Bag of Words. Fijense que es tremendamente útil tenerla dentro de un pipeline ya que fija en un comienzo el vocabulario que tendrá el Bag of Words, evitando discordancias entre los vectores del conjunto de entrenamiento y el de prueba.</p>
</section>
<section id="multinomialnb" class="level4">
<h4 class="anchored" data-anchor-id="multinomialnb">MultinomialNB</h4>
</section>
</section>
</section>
<section id="el-clasificador" class="level2">
<h2 class="anchored" data-anchor-id="el-clasificador">El clasificador</h2>
<section id="creemos-el-clasificador" class="level4">
<h4 class="anchored" data-anchor-id="creemos-el-clasificador">Creemos el clasificador 🧪</h4>
<p><strong>Primero, definimos el pipeline</strong></p>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el vectorizador para convertir el texto a BoW:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer()  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el clasificador que usaremos.</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MultinomialNB()   </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos el pipeline</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>text_clf <span class="op">=</span> Pipeline([(<span class="st">'vect'</span>, vectorizer), (<span class="st">'clf'</span>, clf)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Luego, lo entrenamos</strong></p>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrenamos nuestro pipeline</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>text_clf.fit(X_train, y_train)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>#sk-container-id-10 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-10 {
  color: var(--sklearn-color-text);
}

#sk-container-id-10 pre {
  padding: 0;
}

#sk-container-id-10 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-10 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-10 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-10 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-10 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-10 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-10 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-10 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-10 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-10 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-10 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-10 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-10 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-10 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-10 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-10 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-10 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-10 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-10 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-10 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-10 div.sk-label label.sk-toggleable__label,
#sk-container-id-10 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-10 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-10 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-10 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-10 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-10 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-10 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-10 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-10 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-10 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-10 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-10 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-10" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('vect', CountVectorizer()), ('clf', MultinomialNB())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox"><label for="sk-estimator-id-28" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('vect', CountVectorizer()), ('clf', MultinomialNB())])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox"><label for="sk-estimator-id-29" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;CountVectorizer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">?<span>Documentation for CountVectorizer</span></a></label><div class="sk-toggleable__content fitted"><pre>CountVectorizer()</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox"><label for="sk-estimator-id-30" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;MultinomialNB<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.naive_bayes.MultinomialNB.html">?<span>Documentation for MultinomialNB</span></a></label><div class="sk-toggleable__content fitted"><pre>MultinomialNB()</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p><strong>Y predecimos</strong></p>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> text_clf.predict(X_test)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>y_pred</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['entrevistas', 'entrevistas', 'america-latina', ..., 'chile',
       'region-de-los-lagos', 'entrevistas'], dtype='&lt;U22')</code></pre>
</div>
</div>
<p><strong>Veamos como nos fue:</strong></p>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># algunos ejemplos:</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'content'</span>: X_test, <span class="st">'category'</span>:y_test, <span class="st">'predicted category'</span>: y_pred})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">predicted category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3286</td>
<td>Este miércoles se realizó una reunión en Cor...</td>
<td>entrevistas</td>
<td>entrevistas</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3322</td>
<td>El diputado del Partido Socialista, Leonardo...</td>
<td>entrevistas</td>
<td>entrevistas</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5004</td>
<td>Un ciudadano chileno, que fue sorprendido in...</td>
<td>region-de-la-araucania</td>
<td>america-latina</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1420</td>
<td>El líder norcoreano, Kim Jong Un, afirmó est...</td>
<td>asia</td>
<td>asia</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3785</td>
<td>Bases militares y centros de investigación c...</td>
<td>mediooriente</td>
<td>mediooriente</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7552</td>
<td>La tranquilidad del entorno y sus aguas cris...</td>
<td>viral</td>
<td>curiosidades</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3570</td>
<td>Una polémica se registró la jornada de este ...</td>
<td>europa</td>
<td>europa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7395</td>
<td>El Gobierno postergó, una vez más, la presen...</td>
<td>tu-bolsillo</td>
<td>chile</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6174</td>
<td>Un derrame de combustible se registró en la ...</td>
<td>region-de-valparaiso</td>
<td>region-de-los-lagos</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3254</td>
<td>El Superintendente de Electricidad y Combust...</td>
<td>entrevistas</td>
<td>entrevistas</td>
</tr>
</tbody>
</table>

<p>2621 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-27" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando la matriz de confusión:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># eje x -&gt; predichos</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># eje y -&gt; clase real</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 92   1   0   0  20   2   1   1   1   0   6   0   0   0   1   2   0  21
    0]
 [  0 129   0   1   4   5   4   0   3   1   0   0   0   0   0   0   1   0
    0]
 [  0   2 106   1   0  12   1   0   2   1   0   0   0   0   0   0   0   0
   15]
 [  1   1   7 121   0   6  10   0   4   3   0   0   0   0   0   0   0   0
    0]
 [  5   1   0   0  91   2   0   4   0   0   0   0   1   0   4   5   7   9
    0]
 [  0   0   3   5   0 104   3   0   3   1   1   0   0   0   0   0   0   4
   12]
 [  0   9   1   6   0  12  98   0   2  10   0   0   0   0   0   0   0   0
    0]
 [  1   1   0   0   3   3   0 124   2   1   0   0   0   0   0   0   2   2
    0]
 [  0   3   1   2   0   5   3   0  97   6   0   0   0   0   0   0   0   1
    0]
 [  0   1   0   2   0   3   2   0   4 130   0   0   0   0   0   0   0   0
    0]
 [ 28   2   0   1  20   6   2   1   1   0  52   0   1   0   1   3   0  36
    0]
 [  1   1   0   0  29   0   0   2   2   0   2  63   5   2  11   3  22   3
    1]
 [  2   0   0   0  17   1   0   1   0   0   0   0  91   4   4   2  15   1
    0]
 [  0   0   1   0  18   1   0   0   0   0   0   0  12  75   6   3  21   4
    0]
 [  1   0   0   0  19   0   0   0   0   0   1   0   5   0  87   0  14   1
    1]
 [  5   0   0   0  29   2   0   3   0   0   1   2   0   0  12  67  17   1
    0]
 [  1   0   0   0  21   3   0   0   0   0   1   0   0   0   1   0  92   2
    0]
 [  9   0   0   0  13   2   0   0   0   0   0   0   0   0   0   0   0 101
    0]
 [  0   0   8   3   0  46   3   0   0   0   0   0   0   0   0   0   0   1
   75]]</code></pre>
</div>
</div>
</section>
<section id="métricas-de-evaluación" class="level4">
<h4 class="anchored" data-anchor-id="métricas-de-evaluación">Métricas de Evaluación</h4>
<p>Las métricas definen un puntaje de evaluación que indica que tal le fue al sistema. Hay muchas formas distintas de medir su rendimiento. Entre estas, tenemos:</p>
<ul>
<li><p><code>precision</code>: El número de documentos de una clase clasificados correctamente dividido por el número de documentos totales clasificados como esa clase.</p></li>
<li><p><code>recall</code>: El número de documentos de una clase clasificados correctamente dividido por el número de los documentos que se deberían haber clasificado como esa clase.(número de documentos reales de esa clase).</p></li>
<li><p><code>f1-score</code> : Es la media armónica entre los anteriores.</p></li>
<li><p><code>accuracy</code> : La cantidad de documentos clasificados correctamente versus todos los documentos</p></li>
</ul>
<p>Por otra parte, tenemos dos formas de ver dichas métricas agrupadas:</p>
<ul>
<li><p><code>Macroaveraging</code>: Se computan las métricas por cada clase y luego de promedia.</p></li>
<li><p><code>Microaveraging</code>: Se recolectan las clasificaciones por cada clase, se computa la tabla de contingencia (todos los elementos clasificados) y se evalua. Representa un Macroaveraging ponderado por el número de miembros de una clase.</p></li>
</ul>
<div id="cell-29" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando el classification report:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        precision    recall  f1-score   support

  actualidad-economica       0.63      0.62      0.63       148
        america-latina       0.85      0.87      0.86       148
              animales       0.83      0.76      0.79       140
                  asia       0.85      0.79      0.82       153
                 chile       0.32      0.71      0.44       129
          curiosidades       0.48      0.76      0.59       136
                  eeuu       0.77      0.71      0.74       138
           entrevistas       0.91      0.89      0.90       139
                europa       0.80      0.82      0.81       118
          mediooriente       0.85      0.92      0.88       142
   negocios-y-empresas       0.81      0.34      0.48       154
region-de-la-araucania       0.97      0.43      0.59       147
   region-de-los-lagos       0.79      0.66      0.72       138
    region-de-los-rios       0.93      0.53      0.68       141
  region-de-valparaiso       0.69      0.67      0.68       129
    region-del-bio-bio       0.79      0.48      0.60       139
  region-metropolitana       0.48      0.76      0.59       121
           tu-bolsillo       0.54      0.81      0.65       125
                 viral       0.72      0.55      0.62       136

              accuracy                           0.68      2621
             macro avg       0.74      0.69      0.69      2621
          weighted avg       0.74      0.68      0.69      2621
</code></pre>
</div>
</div>
</section>
<section id="ejecutemos-algunas-consultas" class="level4">
<h4 class="anchored" data-anchor-id="ejecutemos-algunas-consultas">Ejecutemos algunas consultas!</h4>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>text_clf.predict([</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"En puerto montt se encontró un perrito, que aparentemente,"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"habría consumido drogas de alto calibre. Producto de esto,"</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"se ponostíca que padecerá severa caña durante varios dias."</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['region-de-los-lagos'], dtype='&lt;U22')</code></pre>
</div>
</div>
<div id="cell-32" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>text_clf.predict([<span class="st">"kim jong un será el próximo candidato a ministro de educación."</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['asia'], dtype='&lt;U22')</code></pre>
</div>
</div>
<div id="cell-33" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>text_clf.predict([(<span class="st">"El banco mundial presentó para chile un decrecimiento"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"económico de 92% y una inflación de 8239832983289%."</span>)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['actualidad-economica'], dtype='&lt;U22')</code></pre>
</div>
</div>
<hr>
<p>Se ven bastante buenos los resultados. ¿Pero, podremos mejorarlos?</p>
</section>
<section id="preprocesamiento-del-texto" class="level3">
<h3 class="anchored" data-anchor-id="preprocesamiento-del-texto">Preprocesamiento del texto</h3>
<p>Podemos preprocesar los textos?, para intentar mejorar. Es decir, cómo hacemos el proceso de tokenización (separación de las palabras).</p>
<p>Alguna de las técnicas son:</p>
<ul>
<li>Eliminación de Stopwords</li>
<li>Stemming</li>
<li>Lematización</li>
</ul>
<p>Existen otros preprocesadores que agregan información a las oraciones, tales como aquellos que indican negaciones.</p>
<p>A continuación, describiremos con mas detalle cada uno de estas técnicas.</p>
<section id="tokenizar" class="level4">
<h4 class="anchored" data-anchor-id="tokenizar">Tokenizar ➗</h4>
<p>¿Qué era tokenizar?</p>
<pre><code>Es el proceso de convertir una secuencia de carácteres (por ejemplo, una oración) en una secuencia de valores distintos entre si llamados tokens.</code></pre>
<p>Referencia: <a href="https://en.wikipedia.org/wiki/Lexical_analysis#Tokenization">Tokenización en wikipedia</a></p>
<p><strong>spaCy y el objeto nlp</strong></p>
<p><code>nlp</code> es el objeto que nos permite usar e interactuar con la librería <a href="https://spacy.io/"><code>spacy</code></a>. Esta librería incluye variadas herramientras, tales como tokenizar, lematizar, descartar stopwords, entre otras (para este auxiliar, solo utilizaremos las mencionadas). El objeto nlp lo instanciamos en la sección de imports.</p>
<p>Para usarla, simplemente se le pasa el texto como parámetro, como veremos en el siguiente ejemplo:</p>
<div id="cell-37" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>DOC <span class="op">=</span> <span class="st">"hermanito mio te estas pegando el show"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>tokens <span class="op">=</span> []</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> nlp(DOC):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    tokens.append(word)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>tokens</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[hermanito, mio, te, estas, pegando, el, show]</code></pre>
</div>
</div>
<p><strong>Observación</strong>: Para este auxiliar usaremos <code>List Comprehension</code>, otra forma de hacer un for un poco mas reducida. Una muy buena referencia de esto <a href="https://www.programiz.com/python-programming/list-comprehension">aquí</a>.</p>
<p>La operación anterior usando esta sintáxis quedaría como:</p>
<div id="cell-39" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tokens <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> nlp(DOC)]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>tokens</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[hermanito, mio, te, estas, pegando, el, show]</code></pre>
</div>
</div>
</section>
<section id="stopwords" class="level4">
<h4 class="anchored" data-anchor-id="stopwords">Stopwords 🛑</h4>
<p>¿Qué eran las stopwords?</p>
<pre><code>Las Stopwords son palabras muy comunes en nuestro lenguaje y que por lo tanto, no aportan mucha información. Existen múltiples listas de stopwords para muchos idiomas y la aplicación de estas variará caso a caso.</code></pre>
<p>Referencias: <a href="https://en.wikipedia.org/wiki/Stop_words">Stopwords en Wikipedia</a></p>
<p>En este caso, utilizaremos las stopwords inlcuidas en la librería spaCy en español</p>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(STOP_WORDS))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(STOP_WORDS)[<span class="dv">0</span>:<span class="dv">20</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>521
['seis', 'vuestra', 'algún', 'sus', 'debajo', 'saber', 'mías', 'lado', 'o', 'tenido', 'antes', 'da', 'temprano', 'podría', 'podriais', 'suyo', 'través', 'ti', 'acuerdo', 'cuál']</code></pre>
</div>
</div>
</section>
<section id="stemming" class="level4">
<h4 class="anchored" data-anchor-id="stemming">Stemming 🔪</h4>
<p>¿Qué era el stemming?</p>
<pre><code>Son un conjunto de métodos enfocados en reducir cada palabra a su raiz.</code></pre>
<p>Referencia: <a href="https://en.wikipedia.org/wiki/Stemming">Stemming en Wikipedia</a></p>
<p><strong>Ejemplos: </strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>word</th>
<th>stem of the word</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>working</td>
<td>work</td>
</tr>
<tr class="even">
<td>worked</td>
<td>work</td>
</tr>
<tr class="odd">
<td>works</td>
<td>work</td>
</tr>
</tbody>
</table>
<p><strong>nltk</strong></p>
<p>En este caso, utilizaremos la segunda librería de herramientas de nlp: <a href="https://www.nltk.org/"><code>nltk</code></a>. Esta provee una buena herramienta para hacer stemming en español : <code>SnowballStemmer</code></p>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>stemmer <span class="op">=</span> SnowballStemmer(<span class="st">'spanish'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>stemmed_doc <span class="op">=</span> [stemmer.stem(<span class="bu">str</span>(token)) <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stemmed_doc)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['hermanit', 'mio', 'te', 'estas', 'peg', 'el', 'show']</code></pre>
</div>
</div>
</section>
<section id="lematización" class="level4">
<h4 class="anchored" data-anchor-id="lematización">Lematización 🙀</h4>
<p>¿Qué era lematización?</p>
<pre><code>Es el proceso de transformar cada token a su lema, el cual es la palabra base sin ningún tipo de flexión o alteración como las conjugaciones, por ejemplo.</code></pre>
<p>Referencia: <a href="https://en.wikipedia.org/wiki/Lemmatisation">Lematización en wikipedia</a></p>
<p>Refernecia: <a href="https://es.wikipedia.org/wiki/Flexi%C3%B3n_(ling%C3%BC%C3%ADstica)">Flexión en las palabras</a></p>
<p><strong>Ejemplos</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>word</th>
<th>lemma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dije</td>
<td>decir</td>
</tr>
<tr class="even">
<td>guapas</td>
<td>guapo</td>
</tr>
<tr class="odd">
<td>mesa</td>
<td>mesas</td>
</tr>
</tbody>
</table>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Flexi%C3%B3nGato-svg.svg/300px-Flexi%C3%B3nGato-svg.svg.png" alt="Flexión de gato" style="width: 200px;"></p>
<p><strong>Lematizar el texto</strong></p>
<p>Al igual que la tokenización, utilizaremos <code>scpaCy</code> (a través del objeto <code>nlp</code>) para lematizar el contenido.</p>
<div id="cell-45" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lemmatized_content <span class="op">=</span> [word.lemma_ <span class="cf">for</span> word <span class="kw">in</span> nlp(DOC)]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lemmatized_content)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['hermanito', 'mio', 'tú', 'este', 'pegar', 'el', 'show']</code></pre>
</div>
</div>
<p><strong>Discusión:</strong></p>
<pre><code>¿Cuál es mejor?</code></pre>
</section>
</section>
<section id="sistema-de-clasificación-con-preprocesamiento" class="level3">
<h3 class="anchored" data-anchor-id="sistema-de-clasificación-con-preprocesamiento">Sistema de clasificación con preprocesamiento</h3>
<p>Para agregar los tokenizadores en el sistema, creamos funciones que que cada documento de forma individual usando nuestro preprocesador favorito. Luego, <code>CountVectorizer</code> se encargará de usar estas funciones sobre todo el dataset.</p>
<div id="cell-48" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenizers para CountVectorizer</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Solo tokenizar el doc usando spacy.</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenizer(doc):</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [x.orth_ <span class="cf">for</span> x <span class="kw">in</span> nlp(doc)]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenizar y remover las stopwords del doc</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenizer_with_stopwords(doc):</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [x.orth_ <span class="cf">for</span> x <span class="kw">in</span> nlp(doc) <span class="cf">if</span> x.orth_ <span class="kw">not</span> <span class="kw">in</span> STOP_WORDS]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenizar y lematizar.</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenizer_with_lemmatization(doc):</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [x.lemma_ <span class="cf">for</span> x <span class="kw">in</span> nlp(doc)]</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenizar y hacer stemming.</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenizer_with_stemming(doc):</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    stemmer <span class="op">=</span> SnowballStemmer(<span class="st">'spanish'</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [stemmer.stem(word) <span class="cf">for</span> word <span class="kw">in</span> [x.orth_ <span class="cf">for</span> x <span class="kw">in</span> nlp(doc)]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creamos-nuestro-clasificador" class="level4">
<h4 class="anchored" data-anchor-id="creamos-nuestro-clasificador">Creamos nuestro clasificador</h4>
<p><strong>Definimos el pipeline</strong></p>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionamos el tokenizador a usar:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>TOKENIZER <span class="op">=</span> tokenizer_with_stemming</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el vectorizador para convertir el texto a BoW:</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer(analyzer<span class="op">=</span><span class="st">'word'</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                             tokenizer<span class="op">=</span>TOKENIZER,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                             ngram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el clasificador que usaremos.</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MultinomialNB()   </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos el pipeline</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>text_clf_2 <span class="op">=</span> Pipeline([(<span class="st">'vect'</span>, vectorizer), (<span class="st">'clf'</span>, clf)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Entrenamos nuestro pipeline y predecimos</strong></p>
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>text_clf_2.fit(X_train, y_train)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> text_clf_2.predict(X_test)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/pavt/Documents/personal/ufro/2024-2/Ing-datos-civil/id-civil/.id_civil/lib/python3.12/site-packages/sklearn/feature_extraction/text.py:521: UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'
  warnings.warn(</code></pre>
</div>
</div>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando la matriz de confusión:</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'</span><span class="ch">\n\n</span><span class="st">-------------------------------------------------------</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># usando el classification report:</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 88   1   0   0  21   2   2   1   1   0   6   0   0   0   1   2   0  23
    0]
 [  1 130   0   1   3   5   4   0   3   0   0   0   0   0   0   0   1   0
    0]
 [  0   2 110   0   0  10   2   0   2   0   0   0   0   0   0   0   0   0
   14]
 [  2   0   8 119   0   6  11   0   4   3   0   0   0   0   0   0   0   0
    0]
 [  5   2   0   0  91   1   0   5   0   0   0   1   1   0   4   5   6   8
    0]
 [  0   0   3   4   0 107   5   0   1   1   0   0   0   0   0   0   1   4
   10]
 [  0  10   2   7   0  10  94   0   5  10   0   0   0   0   0   0   0   0
    0]
 [  2   2   0   0   6   5   0 118   1   1   0   0   0   0   0   1   2   1
    0]
 [  0   3   1   1   0   5   3   0 100   4   0   0   0   0   0   0   0   1
    0]
 [  0   1   0   2   0   3   2   0   4 130   0   0   0   0   0   0   0   0
    0]
 [ 25   2   0   1  22   6   2   1   1   0  54   0   1   0   1   3   0  35
    0]
 [  1   0   0   0  31   1   0   1   0   0   2  70   4   1  11   3  20   2
    0]
 [  1   0   0   0  15   1   0   1   0   0   0   1  93   4   2   1  19   0
    0]
 [  1   0   0   0  26   0   0   0   0   0   0   0   9  79   5   3  16   2
    0]
 [  1   0   0   0  20   0   0   0   0   0   1   0   5   0  91   0   9   1
    1]
 [  4   0   0   0  29   2   0   2   0   0   1   2   1   0   6  69  22   1
    0]
 [  3   1   0   0  20   3   0   2   0   0   0   0   0   0   1   0  87   4
    0]
 [ 10   0   0   0  11   1   1   0   0   0   1   0   0   0   0   0   0 101
    0]
 [  0   1  11   4   0  49   1   0   1   0   0   0   0   0   0   0   0   0
   69]] 

-------------------------------------------------------

                        precision    recall  f1-score   support

  actualidad-economica       0.61      0.59      0.60       148
        america-latina       0.84      0.88      0.86       148
              animales       0.81      0.79      0.80       140
                  asia       0.86      0.78      0.82       153
                 chile       0.31      0.71      0.43       129
          curiosidades       0.49      0.79      0.61       136
                  eeuu       0.74      0.68      0.71       138
           entrevistas       0.90      0.85      0.87       139
                europa       0.81      0.85      0.83       118
          mediooriente       0.87      0.92      0.89       142
   negocios-y-empresas       0.83      0.35      0.49       154
region-de-la-araucania       0.95      0.48      0.63       147
   region-de-los-lagos       0.82      0.67      0.74       138
    region-de-los-rios       0.94      0.56      0.70       141
  region-de-valparaiso       0.75      0.71      0.73       129
    region-del-bio-bio       0.79      0.50      0.61       139
  region-metropolitana       0.48      0.72      0.57       121
           tu-bolsillo       0.55      0.81      0.66       125
                 viral       0.73      0.51      0.60       136

              accuracy                           0.69      2621
             macro avg       0.74      0.69      0.69      2621
          weighted avg       0.75      0.69      0.69      2621
</code></pre>
</div>
</div>
</section>
<section id="pregunta-abierta-por-qué-no-mejoran-los-resultados" class="level4">
<h4 class="anchored" data-anchor-id="pregunta-abierta-por-qué-no-mejoran-los-resultados">Pregunta abierta: ¿Por qué no mejoran los resultados?</h4>
<p><a href="&quot;https://www.quora.com/Is-it-normal-to-get-better-accuracy-without-stemming-and-lemmatization-than-using-them-in-NLP-text-classification&quot;">Aquí</a> hay una muy buena discusión al respecto.</p>
</section>
</section>
<section id="clasificación-usando-regresión-logísitica" class="level3">
<h3 class="anchored" data-anchor-id="clasificación-usando-regresión-logísitica">Clasificación usando Regresión Logísitica</h3>
<p>No profundizaremos en este clasificador, mas del hecho de que se “supone” que debería tener mejor rendimiento que el de bayes.</p>
<p>Referencia: <a href="https://en.wikipedia.org/wiki/Logistic_regression">Regresión Logística</a></p>
<p><strong>Definimos nuestro Pipeline</strong></p>
<div id="cell-57" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Qué tokenizer usaremos?</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>TOKENIZER <span class="op">=</span> tokenizer_with_lemmatization</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el vectorizador para convertir el texto a BoW:</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer(analyzer<span class="op">=</span><span class="st">'word'</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                             tokenizer<span class="op">=</span>TOKENIZER,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                             ngram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora definimos regresión logística como clasificador.</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>log_mod <span class="op">=</span> LogisticRegression(solver<span class="op">=</span><span class="st">'lbfgs'</span>, multi_class<span class="op">=</span><span class="st">'ovr'</span>, max_iter <span class="op">=</span> <span class="dv">1000</span>)   </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>log_pipe <span class="op">=</span> Pipeline([(<span class="st">'vect'</span>, vectorizer), (<span class="st">'clf'</span>, log_mod)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Entrenamos y predecimos</strong></p>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>log_pipe.fit(X_train, y_train)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> log_pipe.predict(X_test)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/pavt/Documents/personal/ufro/2024-2/Ing-datos-civil/id-civil/.id_civil/lib/python3.12/site-packages/sklearn/feature_extraction/text.py:521: UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'
  warnings.warn(
/Users/pavt/Documents/personal/ufro/2024-2/Ing-datos-civil/id-civil/.id_civil/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1256: FutureWarning: 'multi_class' was deprecated in version 1.5 and will be removed in 1.7. Use OneVsRestClassifier(LogisticRegression(..)) instead. Leave it to its default value to avoid this warning.
  warnings.warn(</code></pre>
</div>
</div>
<p><strong>Evaluamos</strong></p>
<div id="cell-61" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando la matriz de confusión:</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'</span><span class="ch">\n\n</span><span class="st">-------------------------------------------------------</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># usando el classification report:</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 87   1   0   0  12   3   2   0   1   0  17   0   0   0   1   7   0  15
    2]
 [  0 118   0   1   5   2   7   0   9   0   0   1   0   0   0   0   0   2
    3]
 [  0   1 113   3   0   6   1   0   1   0   0   0   0   1   0   0   0   0
   14]
 [  0   3   9 113   0   5  12   0   4   5   1   0   0   0   0   0   0   0
    1]
 [  6   0   0   1  77   2   1   2   0   0   7   5   1   0   5   5  12   5
    0]
 [  0   0   7   6   1  78   3   0   5   1   2   0   0   0   1   0   0   5
   27]
 [  0  10   1   8   1   7  93   0   5   8   0   0   0   0   1   1   0   0
    3]
 [  1   0   0   0   0   1   0 129   1   1   0   1   0   0   0   0   5   0
    0]
 [  0   3   2   0   1   4   4   0  97   5   0   0   0   0   0   0   1   0
    1]
 [  1   0   0   5   0   4   5   0   4 119   1   0   0   0   0   0   1   1
    1]
 [ 17   3   0   0   3   5   0   1   1   0  92   0   1   1   2   6   5  16
    1]
 [  0   0   0   0   4   0   0   1   0   0   1 128   1   2   2   4   2   1
    1]
 [  0   0   0   0   1   0   0   0   0   0   1   5 124   5   1   1   0   0
    0]
 [  0   0   0   0   0   0   0   0   0   0   2   0   4 127   2   4   2   0
    0]
 [  0   0   0   0   2   1   0   1   0   0   3   1   3   0 113   2   3   0
    0]
 [  2   0   0   0   4   1   0   1   0   0   1   3   1   3   3 116   4   0
    0]
 [  1   0   0   1   5   1   0   1   0   0   0   0   1   2   1   2 103   2
    1]
 [ 15   0   0   0   3   3   0   0   0   0  17   0   0   0   2   0   0  84
    1]
 [  0   0   8   6   0  21   3   0   4   0   1   0   0   0   0   0   1   0
   92]] 

-------------------------------------------------------

                        precision    recall  f1-score   support

  actualidad-economica       0.67      0.59      0.63       148
        america-latina       0.85      0.80      0.82       148
              animales       0.81      0.81      0.81       140
                  asia       0.78      0.74      0.76       153
                 chile       0.65      0.60      0.62       129
          curiosidades       0.54      0.57      0.56       136
                  eeuu       0.71      0.67      0.69       138
           entrevistas       0.95      0.93      0.94       139
                europa       0.73      0.82      0.78       118
          mediooriente       0.86      0.84      0.85       142
   negocios-y-empresas       0.63      0.60      0.61       154
region-de-la-araucania       0.89      0.87      0.88       147
   region-de-los-lagos       0.91      0.90      0.91       138
    region-de-los-rios       0.90      0.90      0.90       141
  region-de-valparaiso       0.84      0.88      0.86       129
    region-del-bio-bio       0.78      0.83      0.81       139
  region-metropolitana       0.74      0.85      0.79       121
           tu-bolsillo       0.64      0.67      0.66       125
                 viral       0.62      0.68      0.65       136

              accuracy                           0.76      2621
             macro avg       0.76      0.77      0.76      2621
          weighted avg       0.77      0.76      0.76      2621
</code></pre>
</div>
</div>
</section>
<section id="n-gramas" class="level3">
<h3 class="anchored" data-anchor-id="n-gramas">N-gramas</h3>
<p>Los n-gramas son conjuntos de n-tokens seguidos entre si. La idea de usar esto es que además, capturemos conceptos.</p>
<p>Por ejemplo, si usamos 2-gramas sobre <code>'Hoy día comí lentejas'</code>, esta quedaría como:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">'hoy dia'</span>, <span class="st">'día comí'</span>, <span class="st">'comí lentejas'</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>CountVectorizer</code> tiene la opción para poner n-gramas del tamaño que tu quieras, y además incluir mas pequeños. Todo esto se define en el parámetro <code>ngram_range</code>. Este recibe una tupla con los rangos del n-grama mas pequeño y el mas grande. Por ejemplo, para (1,2), la oración anterior quedaría:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">'hoy'</span>, <span class="st">'día'</span>, <span class="st">'comí'</span>, <span class="st">'lentejas'</span>, <span class="st">'hoy dia'</span>, <span class="st">'día comí'</span>, <span class="st">'comí lentejas'</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Nota que esto incrementa el tamaño de los vectores de Bag of words y por lo tanto, del entrenamiento y de la predicción.</p>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Qué tokenizer usaremos?</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>TOKENIZER <span class="op">=</span> tokenizer_with_lemmatization</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el vectorizador para convertir el texto a BoW:</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer(analyzer<span class="op">=</span><span class="st">'word'</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                             tokenizer<span class="op">=</span>TOKENIZER,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                             ngram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora definimos regresión logística como clasificador.</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>log_mod <span class="op">=</span> LogisticRegression(solver<span class="op">=</span><span class="st">'lbfgs'</span>, multi_class<span class="op">=</span><span class="st">'ovr'</span>, max_iter <span class="op">=</span> <span class="dv">1000</span>)   </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>log_pipe <span class="op">=</span> Pipeline([(<span class="st">'vect'</span>, vectorizer), (<span class="st">'clf'</span>, log_mod)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Entrenamos y predecimos</strong></p>
<div id="cell-65" class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando la matriz de confusión:</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'</span><span class="ch">\n\n</span><span class="st">-------------------------------------------------------</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># usando el classification report:</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 87   1   0   0  12   3   2   0   1   0  17   0   0   0   1   7   0  15
    2]
 [  0 118   0   1   5   2   7   0   9   0   0   1   0   0   0   0   0   2
    3]
 [  0   1 113   3   0   6   1   0   1   0   0   0   0   1   0   0   0   0
   14]
 [  0   3   9 113   0   5  12   0   4   5   1   0   0   0   0   0   0   0
    1]
 [  6   0   0   1  77   2   1   2   0   0   7   5   1   0   5   5  12   5
    0]
 [  0   0   7   6   1  78   3   0   5   1   2   0   0   0   1   0   0   5
   27]
 [  0  10   1   8   1   7  93   0   5   8   0   0   0   0   1   1   0   0
    3]
 [  1   0   0   0   0   1   0 129   1   1   0   1   0   0   0   0   5   0
    0]
 [  0   3   2   0   1   4   4   0  97   5   0   0   0   0   0   0   1   0
    1]
 [  1   0   0   5   0   4   5   0   4 119   1   0   0   0   0   0   1   1
    1]
 [ 17   3   0   0   3   5   0   1   1   0  92   0   1   1   2   6   5  16
    1]
 [  0   0   0   0   4   0   0   1   0   0   1 128   1   2   2   4   2   1
    1]
 [  0   0   0   0   1   0   0   0   0   0   1   5 124   5   1   1   0   0
    0]
 [  0   0   0   0   0   0   0   0   0   0   2   0   4 127   2   4   2   0
    0]
 [  0   0   0   0   2   1   0   1   0   0   3   1   3   0 113   2   3   0
    0]
 [  2   0   0   0   4   1   0   1   0   0   1   3   1   3   3 116   4   0
    0]
 [  1   0   0   1   5   1   0   1   0   0   0   0   1   2   1   2 103   2
    1]
 [ 15   0   0   0   3   3   0   0   0   0  17   0   0   0   2   0   0  84
    1]
 [  0   0   8   6   0  21   3   0   4   0   1   0   0   0   0   0   1   0
   92]] 

-------------------------------------------------------

                        precision    recall  f1-score   support

  actualidad-economica       0.67      0.59      0.63       148
        america-latina       0.85      0.80      0.82       148
              animales       0.81      0.81      0.81       140
                  asia       0.78      0.74      0.76       153
                 chile       0.65      0.60      0.62       129
          curiosidades       0.54      0.57      0.56       136
                  eeuu       0.71      0.67      0.69       138
           entrevistas       0.95      0.93      0.94       139
                europa       0.73      0.82      0.78       118
          mediooriente       0.86      0.84      0.85       142
   negocios-y-empresas       0.63      0.60      0.61       154
region-de-la-araucania       0.89      0.87      0.88       147
   region-de-los-lagos       0.91      0.90      0.91       138
    region-de-los-rios       0.90      0.90      0.90       141
  region-de-valparaiso       0.84      0.88      0.86       129
    region-del-bio-bio       0.78      0.83      0.81       139
  region-metropolitana       0.74      0.85      0.79       121
           tu-bolsillo       0.64      0.67      0.66       125
                 viral       0.62      0.68      0.65       136

              accuracy                           0.76      2621
             macro avg       0.76      0.77      0.76      2621
          weighted avg       0.77      0.76      0.76      2621
</code></pre>
</div>
</div>
</section>
<section id="bonus-clasificación-de-autoría-de-documentos" class="level3">
<h3 class="anchored" data-anchor-id="bonus-clasificación-de-autoría-de-documentos">Bonus: Clasificación de Autoría de documentos</h3>
<p>¿Existirá un patrón en como escriben los periodistas que nos permitan identificarlos a partir de sus textos?</p>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>dataset_r.author.value_counts()[<span class="dv">0</span>:<span class="dv">20</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>author
Diego Vera               4471
Emilio Lara              1380
Matías Vega              1230
César Vega Martínez      1202
María José Villarroel    1157
Gonzalo Cifuentes        1122
Manuel Stuardo           1022
Manuel Cabrera            999
Valentina González        966
Nicole Briones            850
Felipe Delgado            825
Yessenia Márquez          764
Paola Alemán              760
Verónica Reyes            718
Jonathan Flores           618
Nicolás Díaz              592
Sebastián Asencio         544
Catalina Díaz             523
Ariela Muñoz              515
Nicolás Parra             503
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>NUM_SAMPLES <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_datasets_by_author(dataset):</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creamos una nueva columna titulo y contenido.</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> dataset[<span class="st">'title'</span>] <span class="op">+</span> <span class="st">'. '</span> <span class="op">+</span> dataset[<span class="st">'content'</span>] </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># obtenemos las clases</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    subcategory <span class="op">=</span> dataset.author</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dejamos en el dataset solo contenido de la noticia y categoria</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    dataset <span class="op">=</span> pd.DataFrame({<span class="st">'content'</span>: content, <span class="st">'author'</span>: subcategory})</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    selected_authors <span class="op">=</span> [<span class="st">'Diego Vera'</span>, <span class="st">'Emilio Lara'</span>, <span class="st">'Matías Vega'</span>, <span class="st">'César Vega Martínez'</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">'María José Villarroel'</span>, <span class="st">'Gonzalo Cifuentes'</span>, <span class="st">'Manuel Stuardo'</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Manuel Cabrera'</span>, <span class="st">'Valentina González'</span>, <span class="st">'Nicole Briones'</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Felipe Delgado'</span>, <span class="st">'Yessenia Márquez'</span>, <span class="st">'Paola Alemán'</span>, <span class="st">'Verónica Reyes'</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Jonathan Flores'</span>, <span class="st">'Nicolás Díaz'</span>, <span class="st">'Sebastián Asencio'</span>, <span class="st">'Catalina Díaz'</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Ariela Muñoz'</span>, <span class="st">'Nicolás Parra'</span>]</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filtrar solo categorias seleccionadas</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    dataset <span class="op">=</span> dataset[dataset[<span class="st">'author'</span>].isin(selected_authors)]</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># balancear clases</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> dataset.groupby(<span class="st">'author'</span>)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    dataset <span class="op">=</span> pd.DataFrame(</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>        g.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(NUM_SAMPLES).reset_index(drop<span class="op">=</span><span class="va">True</span>))).reset_index(</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>            drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dataset</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>author_dataset <span class="op">=</span> process_datasets_by_author(dataset_r.copy(deep<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>X_train_2, X_test_2, y_train_2, y_test_2 <span class="op">=</span> train_test_split(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    author_dataset.content,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    author_dataset.author,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.33</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/n4/j3zj6_r13rv55gc2c5btztph0000gn/T/ipykernel_42780/4182984880.py:25: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  g.apply(lambda x: x.sample(NUM_SAMPLES).reset_index(drop=True))).reset_index(</code></pre>
</div>
</div>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>author_dataset</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">content</th>
<th data-quarto-table-cell-role="th">author</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Salarios crecen 1,2% pese al alza de la fuerza...</td>
<td>Ariela Muñoz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Ecuador aprueba matrimonio igualitario en hist...</td>
<td>Ariela Muñoz</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Los 10 compromisos que firmó el Gobierno para ...</td>
<td>Ariela Muñoz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Gerente de CCU ante eventual alza de impuesto ...</td>
<td>Ariela Muñoz</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Erupción de volcán al suroeste de Japón elevó ...</td>
<td>Ariela Muñoz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4995</td>
<td>"Traidores nunca, leales siempre": arenga Madu...</td>
<td>Yessenia Márquez</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4996</td>
<td>Solicitan instalación de dispensadores de agua...</td>
<td>Yessenia Márquez</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4997</td>
<td>Detienen a hombre en Atacama que viajaba con 9...</td>
<td>Yessenia Márquez</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4998</td>
<td>Inician sumario sanitario en colegio Darío Sal...</td>
<td>Yessenia Márquez</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4999</td>
<td>Gobierno apoyará a UACh para preservar patrimo...</td>
<td>Yessenia Márquez</td>
</tr>
</tbody>
</table>

<p>5000 rows × 2 columns</p>
</div>
</div>
</div>
<section id="definir-el-pipeline" class="level4">
<h4 class="anchored" data-anchor-id="definir-el-pipeline">Definir el Pipeline</h4>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el vectorizador para convertir el texto a BoW:</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer(analyzer<span class="op">=</span><span class="st">'word'</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                             ngram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el clasificador. Usaremos bayes, ya que regresión logística se demora 1/4 del tiempo del universo.</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> MultinomialNB()   </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos el pipeline</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>log_pipe_by_author <span class="op">=</span> Pipeline([(<span class="st">'vect'</span>, vectorizer), (<span class="st">'clf'</span>, clf)])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="entrenar" class="level4">
<h4 class="anchored" data-anchor-id="entrenar">Entrenar</h4>
<div id="cell-74" class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>log_pipe_by_author.fit(X_train_2, y_train_2)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> log_pipe_by_author.predict(X_test_2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluar" class="level4">
<h4 class="anchored" data-anchor-id="evaluar">Evaluar</h4>
<div id="cell-76" class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando la matriz de confusión:</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test_2, y_pred),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'</span><span class="ch">\n\n</span><span class="st">-------------------------------------------------------</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># usando el classification report:</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_2, y_pred))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 4  5  1 14  0  4  1 27  0  2  7  1  1 10  0  1  0  3 10  3]
 [ 1 32  1  1  1  0  0  2  2  8  4  0  6 11  1  2  2  2  1  8]
 [ 0  0 57  7  0  1  0  2  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  0  1 65  0  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0]
 [ 1  0  0 34  1  2  0 27  0  0  2  0  0  4  1  6  0  2 14  2]
 [ 0  1  0 19  0 33  0  9  0  0  6  0  0  0  0  5  0  2  0  2]
 [ 1  0  2 29  0  7  2 26  0  0  2  1  0  4  0 11  0  1  6  0]
 [ 1  0  0 15  0  0  0 55  0  0  0  0  0  1  0  4  0  0  1  0]
 [ 1  2  1 13  0  3  0  9  7  0  1  1  0 18 12  7  1  3  0  3]
 [ 1  2  0  8  0  1  0 10  1  9  6  1  8 16  0  4  0  1  1 16]
 [ 0  1  0  6  0  8  0  9  0  1 26  0  0  9  1  9  0  2  0  5]
 [ 0  0  0 26  0  6  0 31  1  1  3  3  1  6  1  2  0  0  2  0]
 [ 1  9  0  5  0  1  0  7  0 12  0  0 15 23  2  3  0  1  1  7]
 [ 1  1  0  2  0  5  0 15  0  1  3  0  1 37  2  0  0  1  1  3]
 [ 0  3  1 14  0  2  0 12  4  1  3  0  0 19 13  4  2  1  1  0]
 [ 0  0  1 38  0  0  0  1  0  0  0  0  0  0  0 45  0  0  0  0]
 [ 1  1  0 30  0  0  0 12  0  1  2  1  1  3  2 12  2  0  3  1]
 [ 1  2  0 21  0  8  0 16  0  0 11  1  0  1  0  4  0 11  0  2]
 [ 0  0  0 14  0  1  0 24  0  0  0  1  0  0  1  6  1  0 33  0]
 [ 0  6  2  9  0  2  0 10  0  8  1  0  5 18  3  3  0  1  0 16]] 

-------------------------------------------------------

                       precision    recall  f1-score   support

         Ariela Muñoz       0.29      0.04      0.07        94
        Catalina Díaz       0.49      0.38      0.43        85
  César Vega Martínez       0.85      0.63      0.73        90
           Diego Vera       0.18      0.90      0.29        72
          Emilio Lara       0.50      0.01      0.02        96
       Felipe Delgado       0.39      0.43      0.41        77
    Gonzalo Cifuentes       0.67      0.02      0.04        92
      Jonathan Flores       0.18      0.71      0.29        77
       Manuel Cabrera       0.47      0.09      0.14        82
       Manuel Stuardo       0.20      0.11      0.14        85
María José Villarroel       0.34      0.34      0.34        77
          Matías Vega       0.30      0.04      0.06        83
       Nicole Briones       0.39      0.17      0.24        87
         Nicolás Díaz       0.21      0.51      0.29        73
        Nicolás Parra       0.33      0.16      0.22        80
         Paola Alemán       0.29      0.53      0.37        85
    Sebastián Asencio       0.25      0.03      0.05        72
   Valentina González       0.35      0.14      0.20        78
       Verónica Reyes       0.45      0.41      0.43        81
     Yessenia Márquez       0.24      0.19      0.21        84

             accuracy                           0.28      1650
            macro avg       0.37      0.29      0.25      1650
         weighted avg       0.38      0.28      0.25      1650
</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="referencias" class="level2">
<h2 class="anchored" data-anchor-id="referencias">Referencias</h2>
<p>Slides: - https://web.stanford.edu/~jurafsky/slp3/slides/7_NB.pdf</p>
<p>Análisis de sentimientos como clasificación de texto: - https://affectivetweets.cms.waikato.ac.nz/benchmark/</p>
<p>Algunos Recursos útiles - <a href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">Pandas Cheat Sheet</a> - <a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Scikit_Learn_Cheat_Sheet_Python.pdf">Scikit-learn Cheat Sheet</a> - <a href="https://www.datacamp.com/community/blog/spacy-cheatsheet">Spacy Tutorial</a> - <a href="http://sapir.psych.wisc.edu/programming_for_psychologists/cheat_sheets/Text-Analysis-with-NLTK-Cheatsheet.pdf">NLTK Cheat sheet</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dci-courses\.github\.io\/DatosBook");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dci-courses/DatosBook/issues/new" class="toc-action"><i class="bi bi-github"></i>Informar de un problema</a></li></ul></div></div></div></footer></body></html>